<<expand file="/apps/clear/clear.lib" /expand>>
<!doctype html>
<html lang="en">
 <head>
  <meta charset="utf-8">
  <title>Mock App</title>
  <style>
   body         {webkit-box-sizing:border-box;moz-box-sizing:border-box;box-sizing:border-box;}
   div          {padding: 5px; margin: 10px;}
   #processing  {border: 2px solid green; width: 300px; height: 24px;}
   #message     {border: 2px solid red; width: 300px; height: 100px;}
   #message2    {border: 2px solid red; width: 300px; height: 100px;}
   #colorchoice {background-color: <<mycolor>>; width: 16px; height: 16px;}
   #theform     {border: 2px solid grey; width: 300px;}
   #colors      {border: 2px solid grey; width: 300px;}
   #pizza       {border: 2px solid grey; width: 300px;}
   #select      {border: 2px solid grey; width: 300px;}
   #otherels    {border: 2px solid grey; width: 300px;}
   #filearea    {border: 2px solid grey; width: 300px; height: 500px;}
   #listing     {border: 1px solid blue; width: 270px; height: 420px; overflow: auto;}
   textarea     {width: 290px; height: 50px;}
   select       {width: 150px; height: 150px;}
  </style>
  <script src="<<syspublicurl>>/apps/clear/clearFILE_devel.js?id=002"></script>
  <script>




   function onAJAX(el){
    if (el.name === 'mypath' && CLEAR.f.right(el.value,1) != '/'){
     CLEAR.f.$('processing').innerHTML='Processing';
     setTimeout('CLEAR.f.$("processing").innerHTML="";',100);
     return false;
    }
    clearTimeout(CLEAR.f.processing.timer);
    CLEAR.f.$('processing').innerHTML='Processing';
    return true;
   }




   function afterAJAX(el){
    CLEAR.f.$('processing').innerHTML='';
    CLEAR.f.processing.timer=setTimeout('CLEAR.f.$("message").innerHTML="";',15000);
    return true;
   }
















  </script>
 </head>
 <body>
  <a href="<<page>>">RELOAD</a><hr>
  <form action="dosomething" method="post" tag="<<page>>" ajax enctype="multipart/form-data">
    Processing Area:
    <div id="processing"></div>
    Message Area:
    <div id="message"><<showonce('message')>></div>
    Form Area:
    <div id="theform">
     File:<input type="file" name="file100598" AJAX>
     Username:<input type="text" name="myname" AJAX><br>
     Password:<input type="password" name="mypass" AJAX><br>
     Story (limit to 100 characters):<br><textarea name="mystory" AJAX HOLD></textarea><br>
     <input type="submit" name="mybutton" value="Submit"> | 
     <input type="submit" name="mybutton" value="Cancel" disabled> | 
    </div>
  </form>
 </body>
</html>





<<overlay dosomething
 message='AJAX.clicked='+ajax.clicked()+'<br>'+sysstdin+'<hr>'
 if AJAX.clicked()='mypath' then
  if right(mypath,1)='/' then
   o=writeHTML('listing',myfiles(mypath))
   message=message+'listing: '+mypath
  /if
 elif AJAX.clicked()='myname' then
  if myname='' or myname='ERROR' or myname='Admin' then
   message=message+'Name cannot be blank or Admin'
   myname=''
   o=updateVARS('myname')
  else
   message=message+'"'+myname+'" is available.'
  /if
 elif AJAX.clicked()='mystory' then
  if length(mystory)>100 then
   message=message+'Story must be less than 100 characters. It has been truncated.'
   mystory=left(mystory,100)
   o=updateVARS('mystory')
  else
   message=message+'Story OK'
  /if
 elif AJAX.clicked()='mypass' then
  if length(mypass)<8 then
   message=message+'Password must be at least 8 characters'
  else
   message=message+'Password OK'
  /if
 elif AJAX.clicked()='mytopping' then
  # check for cheese /#
  temp='ERROR'
  for name=mytopping rowname=x do
   if x[1]='cheese' then temp='FOUND' /if
  /for
  if temp='ERROR' then
   mytopping=appends(mytopping,"cheese")
   message=message+'Cheese is required, it has been added.'
  /if
  o=updateVARS('mytopping')
  message=message+'<br>'+rows(mytopping)+' topping(s)<br>'+showtable(mytopping)
 elif AJAX.clicked()='mycolor' then
  o=AJAXgoto('switchcolor')
 elif AJAX.clicked()='mycar' then
  message=message+rows(mycar)+' car maker(s)<br>'+showtable(mycar)
 elif AJAX.clicked()='mybutton' and mybutton="submit" then
  if myname="Admin" or myname="" or myname="ERROR" or mypass="" or mypass="ERROR" or length(mypass)<8 then
   message=message+'Username/Password cannot be blank or Admin, Also password must be 8 characters at least.'
  else
   message=message+'"<span style="color:'+mycolor+';">'+myname+' verified</span>", now click Submit.'
   o=AJAXgoto('secretpage.html')
  /if
 elif AJAX.clicked()='mybutton' and mybutton="logo" then
  message=message+'mybutton.x='+mybutton.x+'<br>mybutton.y='+mybutton.y
 /if
 o=writeHTML('message',message) message="ERROR"
 o=endOVERLAY()
>>





<<overlay switchcolor
 message='AJAX.clicked='+ajax.clicked()+'<br>'
 o=writeHTML('message',message+'Color Changed to: '+mycolor) message="ERROR"
 o=runSCRIPT(^CLEAR.f.$('colorchoice').style.backgroundColor='^+mycolor+^';^)
 o=updateVARS('mycolor')
 o=endOVERLAY()
>>





<<overlay switchpizza
 message='AJAX.clicked='+ajax.clicked()+'<br>'
 if mypizza='plain' then
  mytopping="ERROR"
  mytopping=appends(mytopping,"cheese")
 elif mypizza='meat' then
  mytopping="ERROR"
  mytopping=appends(mytopping,"cheese")
  mytopping=appends(mytopping,"sausage")
  mytopping=appends(mytopping,"pepperoni")
  mytopping=appends(mytopping,"ham")
 elif mypizza='veggie' then
  mytopping="ERROR"
  mytopping=appends(mytopping,"cheese")
  mytopping=appends(mytopping,"olives")
  mytopping=appends(mytopping,"onions")
  mytopping=appends(mytopping,"peppers")
 elif mypizza='all' then
  mytopping="ERROR"
  mytopping=appends(mytopping,"cheese")
  mytopping=appends(mytopping,"sausage")
  mytopping=appends(mytopping,"pepperoni")
  mytopping=appends(mytopping,"ham")
  mytopping=appends(mytopping,"olives")
  mytopping=appends(mytopping,"onions")
  mytopping=appends(mytopping,"peppers")
 /if
 o=writeHTML('message',message+'Pizza Changed to: '+mypizza+'<br>'+showtable(mytopping)) message="ERROR"
 o=updateVARS('mytopping')
 o=endOVERLAY()
>>





<<overlay pickcontinent
 message='AJAX.clicked='+ajax.clicked()+'<br>'
 if mycontinent='North America' then
  mycar="ERROR"
  mycar=appends(mycar,"Ford")
  mycar=appends(mycar,"Chevy")
  mycar=appends(mycar,"Chrysler")
 elif mycontinent='Europe' then
  mycar="ERROR"
  mycar=appends(mycar,"Volvo")
  mycar=appends(mycar,"Saab")
  mycar=appends(mycar,"Mercedes")
 elif mycontinent='Asia' then
  mycar="ERROR"
  mycar=appends(mycar,"Honda")
  mycar=appends(mycar,"Toyota")
  mycar=appends(mycar,"Subaru")
 elif mycontinent='Africa' then
  mycar="ERROR"
 /if
 o=writeHTML('message',message+'Cars from: '+mycontinent+'<br>'+showtable(mycar)) message="ERROR"
 o=updateVARS('mycar')
 o=endOVERLAY()
>>




<<overlay badoverlay

 ;ljdfl; 

>>




<<overlay badjavascript
 message='AJAX.clicked='+ajax.clicked()+'<br>'
 o=writeHTML('message',message+'This has bad javascript.') message="ERROR"
 o=runSCRIPT(^(t.* qw 56  // this line should generate an error.^)
 o=endOVERLAY()
>>




<<overlay debug
 if debug='true' then debug='false' else debug='true' /if
 message='AJAX.clicked='+ajax.clicked()+'<br>'
 o=writeHTML('message',message+'Debug is: '+debug) message="ERROR"
 o=writeHTML('debuglink','Toggle Debug (Currently:'+debug+')')
 o=runSCRIPT(^CLEAR.debug=^+debug)
 o=endOVERLAY()
>>




<<overlay showraw
 message='AJAX.clicked='+ajax.clicked()+'<br>'
 if showraw='true' then showraw='false' else showraw='true' /if
 o=writeHTML('message',message+'showraw is: '+showraw) message="ERROR"
 o=endOVERLAY()
>>